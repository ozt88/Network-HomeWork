function Character(){this.posX=canvas.width/2,this.posY=canvas.height/2,this.width=10,this.height=10,this.vX=0,this.vY=0,this.accX=0,this.accY=0,this.isAlive=!0,this.image=new Image,this.image.src="http://img2.wikia.nocookie.net/__cb20110324230458/kirby/en/images/3/32/Kirby_character.png"}function Poo(){this.posX=0,this.posY=0,this.width=10,this.height=10,this.vX=0,this.vY=2.5,this.isVisible=!0,this.image=new Image,this.image.src="http://www.charbase.com/images/glyph/128169"}function onKeyDown(t){console.log(t),PooWorld.character.move(t)}function onKeyUp(){PooWorld.character.stop()}Character.prototype.move=function(t){var i=t.keyCode;37==i&&(this.accX=-.03),39==i&&(this.accX=.03),38==i&&(this.accY=-.03),40==i&&(this.accY=.03)},Character.prototype.stop=function(){this.accX=0,this.accY=0},Character.prototype.friction=function(t){var i=0;return t>0?i=-.01:0>t&&(i=.01),i},Character.prototype.init=function(){this.isAlive=!0},Character.prototype.update=function(t){Math.abs(this.vX+this.accX)<100&&(this.vX+=(this.accX+this.friction(this.vX))*t,this.vY+=(this.accY+this.friction(this.vY))*t),this.posX+this.vX*t>10&&this.posX+this.vX*t<canvas.width-4*this.width&&(this.posX+=this.vX*t),this.posY+this.vY*t>10&&this.posY+this.vY*t<canvas.height-4*this.height&&(this.posY+=this.vY*t)};var xd=[];Character.prototype.render=function(){this.isAlive&&context.drawImage(this.image,this.posX-this.width/2,this.posY-this.height/2,4*this.width,4*this.height)},Poo.prototype.update=function(t){this.posY>canvas.height&&(this.isVisible=!1),this.posY+=this.vY*t},Poo.prototype.init=function(){this.posX=Math.random()*canvas.width,this.posY=0,this.isVisible=!0},Poo.prototype.render=function(){context.drawImage(this.image,this.posX-this.width/2,this.posY-this.height/2,this.width,this.height)},Poo.prototype.hitCheck=function(t,i,o){return Math.pow(this.posX-t,2)+Math.pow(this.posY-i,2)<Math.pow(this.height+o,2)};var PooWorld={},canvas=document.querySelector("canvas"),context=canvas.getContext("2d"),deltaT=60;PooWorld.character=new Character,PooWorld.pooList=[],PooWorld.score=0,PooWorld.width=canvas.width,PooWorld.height=canvas.height,PooWorld.isGameEnd=!1,document.addEventListener("keydown",onKeyDown),document.addEventListener("keyup",onKeyUp),PooWorld.PooFactory={accTime:0,checkTime:300,PooNum:0,update:function(t){this.accTime+=t,this.accTime>this.checkTime&&(this.accTime=0,this.checkTime>20&&(this.checkTime-=this.checkTime/10),PooWorld.addPoo())}},PooWorld.collisionCheck=function(){for(var t=0;t<this.pooList.length;++t)this.pooList[t].hitCheck(this.character.posX,this.character.posY,this.character.height)&&(this.pooList[t].isVisible=!1,this.character.isAlive=!1,this.isGameEnd=!0)},PooWorld.addPoo=function(){var t=new Poo;t.init(),this.pooList.push(t)},PooWorld.init=function(){this.character.init()},PooWorld.update=function(t){if(0==this.isGameEnd){this.collisionCheck(),this.PooFactory.update(t),this.character.update(t);for(var i=0;i<this.pooList.length;++i)this.pooList[i].update(t),0==this.pooList[i].isVisible&&(this.pooList.splice(i,1),this.score++)}},PooWorld.render=function(){this.character.render();for(var t=0;t<this.pooList.length;++t)this.pooList[t].render();context.font="30px Arial",context.fillStyle="black",context.fillText(this.score.toString(),10,50)},function(){function t(){i.width=window.innerWidth,i.height=window.innerHeight}document.body.style.width="100%",document.body.style.height="100%",document.body.style.margin="0",document.body.style.overflow="hidden";var i=document.getElementById("canvas");t(),window.addEventListener("resize",t)}(),PooWorld.init();var MainInterval=setInterval(function(){context.fillStyle="white",context.fillRect(0,0,canvas.width,canvas.height),PooWorld.update(deltaT),PooWorld.render()},deltaT);